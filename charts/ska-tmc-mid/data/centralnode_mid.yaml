name: "centralnode-test"
function: telescope-monitoring
domain: general-monitoring
instances: ["01"]
entrypoints:
  - name: "ska_tmc_centralnode.central_node_mid.CentralNodeMid"
server:
  name: "central_node_mid"
  instances:
  - name: "01"
    classes:
    - name: "CentralNodeMid"
      devices:
      - name: "ska_mid/tm_central/central_node"
        properties:
        - name: "CspMasterLeafNodeFQDN"
          values:
          - "ska_mid/tm_leaf_node/csp_master"
        - name: "CspMasterFQDN"
          values:
          - "mid-csp/control/0"
        - name: "SdpMasterLeafNodeFQDN"
          values:
          - "ska_mid/tm_leaf_node/sdp_master"
        - name: "SdpMasterFQDN"
          values:
          - "mid-sdp/control/0"
        - name: "DishLeafNodePrefix"
          values:
          - "ska_mid/tm_leaf_node/d"
        - name: "NumDishes"
          values:
          - "4"
        - name: "TMCSubarrayNodes"
          values:
          {{- range  ( regexSplit " " ((.Values.deviceServers.centralnode.subarray_count | int) | seq ) -1 )  }}
          - "ska_mid/tm_subarray_node/{{ . }}"
          {{- end }}
        - name: "TMCMidCspSubarrayLeafNodes"
          values:
          {{- range  ( regexSplit " " ((.Values.deviceServers.centralnode.subarray_count | int) | seq ) -1 )  }}
          - "ska_mid/tm_leaf_node/csp_subarray{{ printf "%02s" . }}"
          {{- end }}
        - name: "TMCMidSdpSubarrayLeafNodes"
          values:
          {{- range  ( regexSplit " " ((.Values.deviceServers.centralnode.subarray_count | int) | seq ) -1 )  }}
          - "ska_mid/tm_leaf_node/sdp_subarray{{ printf "%02s" . }}"
          {{- end }}
        - name: "SkaLevel"
          values:
            - "1"
        - name: "LoggingTargetsDefault"
          values:
            - "tango::logger"
        - name: "LoggingLevelDefault"
          values:
            - "5"
depends_on:
  - device: sys/database/2
image:
  registry: "{{.Values.centralnode.image.registry}}"
  image: "{{.Values.centralnode.image.image}}"
  tag: "{{.Values.centralnode.image.tag}}"
  pullPolicy: "{{.Values.centralnode.image.pullPolicy}}"

